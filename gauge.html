<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>비트코인 공포 & 탐욕 지수</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0a0f;
            color: #e4e4e7;
            font-family: 'Noto Sans KR', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .dashboard {
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        .title {
            font-size: 1.75rem;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 24px;
            letter-spacing: -0.02em;
        }

        .gauge-container {
            position: relative;
            width: 300px;
            height: 200px;
            margin: 0 auto 16px;
        }

        .gauge-svg {
            width: 100%;
            height: 100%;
            overflow: visible;
        }

        /* Gauge arc segments */
        .gauge-segment {
            fill: none;
            stroke-width: 24;
            stroke-linecap: butt;
        }

        /* 5 zones: Extreme Fear, Fear, Neutral, Greed, Extreme Greed */
        .segment-extreme-fear {
            stroke: #16a34a;
        }

        .segment-fear {
            stroke: #86efac;
        }

        .segment-neutral {
            stroke: #eab308;
        }

        .segment-greed {
            stroke: #f97316;
        }

        .segment-extreme-greed {
            stroke: #ef4444;
        }

        /* Needle */
        .needle {
            fill: #22d3ee;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
            transition: transform 1s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform-origin: 150px 150px;
        }

        .needle-center {
            fill: #18181b;
            stroke: #22d3ee;
            stroke-width: 2;
        }

        /* Value display */
        .value-container {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }

        .value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 3.5rem;
            font-weight: 700;
            color: #ffffff;
            line-height: 1;
        }

        .zone-label {
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 8px;
            padding: 4px 16px;
            border-radius: 4px;
            display: inline-block;
        }

        .zone-label.extreme-fear {
            color: #16a34a;
            background: rgba(22, 163, 74, 0.15);
        }

        .zone-label.fear {
            color: #86efac;
            background: rgba(134, 239, 172, 0.15);
        }

        .zone-label.neutral {
            color: #eab308;
            background: rgba(234, 179, 8, 0.15);
        }

        .zone-label.greed {
            color: #f97316;
            background: rgba(249, 115, 22, 0.15);
        }

        .zone-label.extreme-greed {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.15);
        }

        /* Zone markers */
        .zone-markers {
            display: flex;
            justify-content: space-between;
            width: 300px;
            margin: 8px auto 0;
            padding: 0 12px;
        }

        .zone-marker {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: #52525b;
        }

        /* Last updated */
        .last-updated {
            margin-top: 20px;
            font-size: 0.75rem;
            color: #52525b;
        }

        /* Loading state */
        .loading .value {
            color: #52525b;
        }

        @media (max-width: 400px) {
            .gauge-container {
                width: 260px;
                height: 170px;
            }

            .value {
                font-size: 2.75rem;
            }

            .zone-markers {
                width: 260px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <h1 class="title">비트코인 공포 & 탐욕 지수</h1>
        
        <div class="gauge-container">
            <svg class="gauge-svg" viewBox="0 0 300 180">
                <!-- Gauge background segments (5 zones) -->
                <!-- Extreme Fear: 0-25 -->
                <path class="gauge-segment segment-extreme-fear" 
                      d="M 25 150 A 125 125 0 0 1 43 80" />
                <!-- Fear: 25-45 -->
                <path class="gauge-segment segment-fear" 
                      d="M 43 80 A 125 125 0 0 1 100 35" />
                <!-- Neutral: 45-55 -->
                <path class="gauge-segment segment-neutral" 
                      d="M 100 35 A 125 125 0 0 1 200 35" />
                <!-- Greed: 55-75 -->
                <path class="gauge-segment segment-greed" 
                      d="M 200 35 A 125 125 0 0 1 257 80" />
                <!-- Extreme Greed: 75-100 -->
                <path class="gauge-segment segment-extreme-greed" 
                      d="M 257 80 A 125 125 0 0 1 275 150" />
                
                <!-- Needle (will be rotated via JS) -->
                <g class="needle" id="needle">
                    <polygon points="150,45 144,150 150,140 156,150" />
                </g>
                
                <!-- Center circle -->
                <circle class="needle-center" cx="150" cy="150" r="8" />
            </svg>
            
            <div class="value-container">
                <div class="value" id="index-value">--</div>
                <div class="zone-label neutral" id="zone-label">로딩중...</div>
            </div>
        </div>
        
        <div class="zone-markers">
            <span class="zone-marker">0</span>
            <span class="zone-marker">25</span>
            <span class="zone-marker">50</span>
            <span class="zone-marker">75</span>
            <span class="zone-marker">100</span>
        </div>
        
        <div class="last-updated" id="last-updated"></div>
    </div>

    <script>
        async function loadData() {
            try {
                const response = await fetch('data.json');
                if (!response.ok) throw new Error('Data not found');
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Error loading data:', error);
                return null;
            }
        }

        function getZoneInfo(value) {
            if (value <= 25) {
                return { name: '극단적 공포', class: 'extreme-fear' };
            } else if (value <= 45) {
                return { name: '공포', class: 'fear' };
            } else if (value <= 55) {
                return { name: '중립', class: 'neutral' };
            } else if (value <= 75) {
                return { name: '탐욕', class: 'greed' };
            } else {
                return { name: '극단적 탐욕', class: 'extreme-greed' };
            }
        }

        function setNeedleRotation(value) {
            // Value 0 = -90deg (left), Value 100 = 90deg (right)
            // So rotation = (value / 100) * 180 - 90
            const rotation = (value / 100) * 180 - 90;
            const needle = document.getElementById('needle');
            needle.style.transform = `rotate(${rotation}deg)`;
        }

        function formatDate(isoString) {
            const date = new Date(isoString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        async function init() {
            const data = await loadData();
            
            if (!data || !data.fng_index || data.fng_index.length === 0) {
                document.getElementById('index-value').textContent = '--';
                document.getElementById('zone-label').textContent = '데이터 없음';
                return;
            }

            // Get latest Fear & Greed value
            const latestValue = data.fng_index[data.fng_index.length - 1];
            const roundedValue = Math.round(latestValue);
            
            // Update display
            document.getElementById('index-value').textContent = roundedValue;
            
            // Update zone label
            const zoneInfo = getZoneInfo(roundedValue);
            const zoneLabelEl = document.getElementById('zone-label');
            zoneLabelEl.textContent = zoneInfo.name;
            zoneLabelEl.className = `zone-label ${zoneInfo.class}`;
            
            // Animate needle
            setTimeout(() => {
                setNeedleRotation(roundedValue);
            }, 100);
            
            // Update last updated
            if (data.last_updated) {
                document.getElementById('last-updated').textContent = 
                    `마지막 업데이트: ${formatDate(data.last_updated)}`;
            }
        }

        init();
    </script>
</body>
</html>
